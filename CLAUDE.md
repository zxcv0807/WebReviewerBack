# Claude Code 프로젝트 설정

## 프로젝트 개요
**웹사이트 리뷰 및 피싱 사이트 신고 플랫폼 백엔드**
- FastAPI + Supabase 기반 REST API
- Google OAuth 2.0 소셜 로그인 지원
- 웹사이트 리뷰, 피싱 신고, 게시판, 이미지지 업로드 기능

이 파일은 Claude Code가 이 프로젝트에서 작업할 때 따라야 할 가이드라인을 정의합니다.

## 코드 수정 시 필수 설명 형식

모든 코드 수정 시 다음 형식으로 설명을 제공해야 합니다:

### 🔍 기존 코드 분석
- 현재 코드의 상태와 구조
- 발견된 문제점이나 개선이 필요한 부분
- 보안, 성능, 가독성 관점에서의 이슈

### ⚠️ 수정이 필요한 이유
- 왜 이 수정이 필요한지 구체적인 이유
- 어떤 문제를 해결하거나 위험을 방지하는지
- 비즈니스 로직이나 사용자 경험 개선 측면

### ✨ 개선사항
- 수정 후 얻는 구체적인 장점들
- 보안 강화, 성능 향상, 유지보수성 개선 등
- 새로 추가된 기능이나 검증 로직의 설명

### 🛠️ 추가 설정 필요사항
- 새로 추가된 환경변수나 설정 파일
- 배포 시 주의사항이나 마이그레이션 필요사항
- 의존성 설치나 추가 설정이 필요한 경우

## 프로젝트별 코딩 규칙

### 보안 우선 원칙
- 모든 사용자 입력에 대한 검증 필수
- 민감한 정보는 환경변수로 관리
- 로깅 시 개인정보나 민감 데이터 노출 금지

### 코드 품질 기준
- 주석보다는 명확한 변수명과 함수명 사용
- 하드코딩된 값들은 환경변수나 상수로 분리
- 에러 처리는 구체적이고 의미있는 메시지 제공

### 환경변수 관리
- 모든 설정값은 환경변수로 관리
- 기본값 제공으로 개발 환경 편의성 확보
- 민감한 정보를 하드코딩할 때에는 반드시 경고고

### 로깅 및 모니터링
- print 문 대신 적절한 로그 레벨 사용
- 에러 발생 시 충분한 컨텍스트 정보 포함
- 운영 환경에서 디버그 정보 노출 방지

## 특별 주의사항

### 인증 관련 코드
- JWT 토큰 처리 시 보안 검증 철저히
- 쿠키 설정 시 보안 플래그 적절히 설정
- OAuth 처리 시 상태 검증 및 에러 처리 강화

### 데이터베이스 작업
- SQL Injection 방지를 위한 파라미터 바인딩
- 트랜잭션 처리 시 롤백 로직 포함
- 데이터 검증 후 저장

### API 엔드포인트
- 입력 검증은 Pydantic 모델 활용
- 적절한 HTTP 상태 코드 반환
- API 문서화를 위한 태그와 설명 추가

## 성능 및 확장성 고려사항

### 데이터베이스 최적화
- 필요한 필드만 SELECT하여 네트워크 트래픽 최소화
- 인덱스 활용을 고려한 쿼리 작성
- N+1 쿼리 문제 방지

### API 응답 최적화
- 페이지네이션 구현으로 대용량 데이터 처리
- 캐싱 전략 고려 (적절한 경우)
- 응답 데이터 구조 최적화

### 메모리 및 리소스 관리
- 파일 업로드 시 메모리 사용량 제한
- 외부 API 호출 시 타임아웃 설정
- 커넥션 풀 관리

## 테스트 및 검증 가이드라인

### 코드 변경 후 확인사항
- FastAPI 서버 정상 시작 확인
- Swagger UI (/docs)에서 API 문서 확인
- 주요 엔드포인트 기본 동작 테스트
- 에러 로그 모니터링

### 보안 검증 체크리스트
- 사용자 입력 검증 확인
- 인증이 필요한 엔드포인트 보호 확인
- 민감한 정보 로깅 여부 점검
- CORS 설정 적절성 확인

## 프로젝트 특화 규칙

### 웹사이트 리뷰 기능
- 리뷰 평점은 0-5 범위 검증 필수
- 댓글과 리뷰의 평균 평점 계산 로직 정확성 확인
- URL 형식 검증 및 정규화

### 피싱 사이트 신고 기능
- 신고된 URL의 안전성 검증
- 관리자 권한 검증 철저히
- 신고 상태 관리 워크플로우 준수

### 파일 업로드 기능
- 허용된 파일 형식만 업로드 가능
- 파일 크기 제한 준수
- 업로드 경로 보안 확인

### Google OAuth 연동
- 사용자명 중복 시 자동 처리 로직
- 기존 계정과 Google 계정 연동 처리
- OAuth 에러 상황별 적절한 응답